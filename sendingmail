&НаКлиенте
Процедура ОтправитьСообщение(Команда)
	
	Профиль = Новый ИнтернетПочтовыйПрофиль;
   Профиль.АдресСервераSMTP = "smtp.mail.ru";
   Профиль.ПользовательSMTP = "***@mail.ru";	//почта отправителя
   Профиль.ПарольSMTP = "***";	//пароль от ящика
   Профиль.ИспользоватьSSLSMTP = Истина;
   Профиль.ПортSMTP = 465; 
   Профиль.АутентификацияSMTP = СпособSMTPАутентификации.Login;

   Письмо = Новый ИнтернетПочтовоеСообщение;
   Текст = Письмо.Тексты.Добавить("********");
   Текст.ТипТекста = ТипТекстаПочтовогоСообщения.ПростойТекст;
   Письмо.Тема = "*****"; 
   Письмо.Отправитель = "***@mail.ru"; 
   Письмо.ИмяОтправителя = "****";
   Письмо.Получатели.Добавить("***"); //любая почта
   Письмо.Вложения.Добавить(Новый ДвоичныеДанные("d:\тест.txt"),"тест.txt");
   
   Почта = Новый ИнтернетПочта;     
   Попытка
      Почта.Подключиться(Профиль);
      Сообщить("Подключено");
   Исключение
       Сообщить("Не удалось подключиться к серверу");
       Сообщить(ОписаниеОшибки());
   КонецПопытки;
   Попытка
      Почта.Послать(Письмо);
      Сообщить("Письмо отправлено");
   Исключение
       Сообщить("Не удалось отправить письмо");
       Сообщить(ОписаниеОшибки());
   КонецПопытки;
    
   Почта.Отключиться();
   Сообщить("Соединение завершено");
	 
 КонецПроцедуры
